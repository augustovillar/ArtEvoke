# 🤖 Qwen Evaluation - SemArt Dataset

This module evaluates the performance of the Qwen models using outputs stored in CSV format. It assumes that the SemArt dataset has already been downloaded and prepared.

## 📁 Project Structure

```
llama/
├── qwen_env/ 
├── qwen_output.csv # Main output CSV from LLaMA evaluation
├── README.md # This file
├── requirements.txt # Python dependencies
└── testLlama.py # Script to run the LLaMA output evaluation
```

## ✅ Requirements

Make sure you have Python 3.10+ installed. You will also need to have the **SemArt dataset** available locally and preprocessed.

## 🛠️ Installation

It's recommended to use a virtual environment:

```bash
# Create virtual environment
python -m venv qwen_env
source qwen_env/bin/activate  # On Windows use: qwen_env\Scripts\activate

pip install -r requirements.txt
```

## ▶️ 1.Running the Evaluation

To run the evaluation on the Qwen outputs:

```bash
python testLlama.py
```

### ⚙️ 2. 2000 images with Multiprocessing

To generate descriptions for the entire `SemArt2000` dataset using **two GPUs in parallel**:

```bash
python generate2000Sampling.py
```

This will:

- Split the dataset in two  
- Run each half on a separate GPU  
- Save intermediate results to `qwen_output_gpu0.csv` and `qwen_output_gpu1.csv`  
- Merge the outputs into `qwen_output2000.csv` and delete the partials  

> ℹ️ **Note:** Make sure both **GPU 0** and **GPU 1** are available and idle before running this script.

## 📊 Output

The final CSV files will include the following:

### `qwen_output.csv`
Generated by `testLlama.py`, this file contains:

- **Original image filename**
- **Description** per model-resolution combination (e.g., 3B/7B + pixel size)
- **Inference time** per image (in seconds)
- **Allocated GPU memory** (in MB) during generation
- **Reserved GPU memory** (in MB) during generation
- Cleaned metadata for each image

### `qwen_output2000.csv`
Generated by `generate2000Sampling.py`, this file contains:

- **Original image filename**
- **Single description** generated by `Qwen2.5-VL-7B-Instruct` at 512×512 resolution
- Cleaned metadata for bulk testing and integration

> The `qwen_output2000.csv` is used for testing other parts of the project, while `qwen_output.csv` is best for comparative model evaluation.

